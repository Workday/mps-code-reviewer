{ ->
  def downloadFile = mps.downloadDir + "/MPS-${mps.build}.zip"
  def eapSuffix = mps.build.contains("EAP") ? " EAP" : ""
  def unpackedDir = mps.downloadDir + "/MPS ${mps.major}${eapSuffix}"

  task downloadMps(type: Download) {
    doFirst {
      def downloadDir = file(mps.downloadDir)
      if (!downloadDir.exists()) {
          ant.mkdir(dir: downloadDir)
      }
    }
    src "http://download.jetbrains.com/mps/${mps.major}/MPS-${mps.build}.zip"
    dest downloadFile
    overwrite false
  }

  task unzipMps(type: Copy, dependsOn: downloadMps) {
    from zipTree(downloadFile)
    into mps.downloadDir
    doLast {
      println "MPS extracted to: " + unpackedDir
    }
  }

  task getMps(dependsOn: unzipMps)
}()